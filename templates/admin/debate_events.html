{% extends "base.html" %}

{% block title %}Debaters Circle - Admin{% endblock %}

{% block content %}
<div class="hero-card">
    <div class="hero-card__inner">
        <div>
            <h1 class="hero-card__title">Debaters Circle</h1>
            <p class="hero-card__subtitle">Curate debate events and track prevention advocate engagement</p>
        </div>
        <div class="hero-card__actions">
            <a href="{{ url_for('admin.create_debate_event') }}" class="btn btn--cta">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                New Debate Event
            </a>
            <a href="{{ url_for('admin.workstreams') }}" class="btn btn--secondary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Workstreams
            </a>
        </div>
    </div>
</div>

<div class="grid grid--3-col mb-lg" style="gap: 1rem;">
    <div class="tile" style="background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); color: white;">
        <div class="tile__value" style="color: white;">{{ stats.total }}</div>
        <div class="tile__label" style="color: rgba(255,255,255,0.9);">Total Debates</div>
    </div>
    <div class="tile" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white;">
        <div class="tile__value" style="color: white;">{{ stats.upcoming }}</div>
        <div class="tile__label" style="color: rgba(255,255,255,0.9);">Upcoming</div>
    </div>
    <div class="tile" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;">
        <div class="tile__value" style="color: white;">{{ stats.completed }}</div>
        <div class="tile__label" style="color: rgba(255,255,255,0.9);">Completed</div>
    </div>
</div>

<div class="mb-lg" style="background: white; border-radius: 12px; padding: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08);">
    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center;">
        <span style="font-weight: 700; color: #374151;">Status:</span>
        <a href="{{ url_for('admin.debates', status='all') }}" class="btn {{ 'btn--primary' if status_filter == 'all' else 'btn--secondary' }}">All</a>
        <a href="{{ url_for('admin.debates', status='Upcoming') }}" class="btn {{ 'btn--primary' if status_filter == 'Upcoming' else 'btn--secondary' }}">Upcoming</a>
        <a href="{{ url_for('admin.debates', status='Ongoing') }}" class="btn {{ 'btn--primary' if status_filter == 'Ongoing' else 'btn--secondary' }}">Ongoing</a>
        <a href="{{ url_for('admin.debates', status='Completed') }}" class="btn {{ 'btn--primary' if status_filter == 'Completed' else 'btn--secondary' }}">Completed</a>
        <a href="{{ url_for('admin.debates', status='Cancelled') }}" class="btn {{ 'btn--primary' if status_filter == 'Cancelled' else 'btn--secondary' }}">Cancelled</a>
    </div>
</div>

{% if events %}
<div class="grid" style="gap: 1.25rem;">
    {% for event in events %}
    <div class="tile" style="border-left: 4px solid {% if event.status == 'Completed' %}#22c55e{% elif event.status == 'Upcoming' %}#0ea5e9{% elif event.status == 'Ongoing' %}#f59e0b{% else %}#cbd5e1{% endif %};">
        <div style="display: flex; gap: 1rem;">
            <div style="flex: 1; min-width: 0;">
                <div style="display: flex; justify-content: space-between; gap: 1rem; align-items: flex-start;">
                    <div style="flex: 1; min-width: 0;">
                        <h3 style="margin: 0; color: #111827;">{{ event.title }}</h3>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.35rem;">
                            <span class="pill pill--secondary">{{ event.status }}</span>
                            <span class="pill" style="background: #e0f2fe; color: #0ea5e9;">{{ event.event_date.strftime('%b %d, %Y %I:%M %p') }}</span>
                            {% if event.location %}<span class="pill" style="background: #f8fafc; color: #475569;">{{ event.location }}</span>{% endif %}
                        </div>
                    </div>
                    <div style="text-align: right; color: #64748b; font-size: 0.9rem;">
                        <div>Created {{ event.created_at.strftime('%b %d, %Y') if event.created_at else '—' }}</div>
                        <div>Updated {{ event.updated_at.strftime('%b %d, %Y') if event.updated_at else '—' }}</div>
                    </div>
                </div>

                {% if event.description %}
                <p style="margin: 0.75rem 0; color: #4b5563;">{{ event.description[:200] }}{% if event.description|length > 200 %}...{% endif %}</p>
                {% endif %}

                <div style="display: flex; gap: 1rem; flex-wrap: wrap; font-size: 0.9rem; color: #4b5563;">
                    {% if event.organizer %}<div style="display: flex; align-items: center; gap: 0.4rem;"><strong>Organizer:</strong> {{ event.organizer }}</div>{% endif %}
                    {% if event.max_participants %}<div style="display: flex; align-items: center; gap: 0.4rem;"><strong>Capacity:</strong> {{ event.max_participants }}</div>{% endif %}
                    {% if event.registration_deadline %}<div style="display: flex; align-items: center; gap: 0.4rem;"><strong>Register by:</strong> {{ event.registration_deadline.strftime('%b %d, %Y %I:%M %p') }}</div>{% endif %}
                </div>

                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 1rem;">
                    <a href="{{ url_for('admin.edit_debate_event', event_id=event.event_id) }}" class="btn btn--secondary" style="font-size: 0.9rem;">Edit</a>
                    <form method="POST" action="{{ url_for('admin.delete_debate_event', event_id=event.event_id) }}" style="display: inline;" onsubmit="return confirm('Delete this event?');">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" class="btn btn--danger" style="font-size: 0.9rem;">Delete</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="tile" style="text-align: center; padding: 3rem;">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="1" style="margin: 0 auto 1rem;">
        <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
    </svg>
    <h3 style="color: #6b7280; margin-bottom: 0.5rem;">No Debaters Circle events</h3>
    <p style="color: #9ca3af; margin-bottom: 1.5rem;">Start by creating your first debate session.</p>
    <a href="{{ url_for('admin.create_debate_event') }}" class="btn btn--primary">Create Event</a>
</div>
{% endif %}
{% endblock %}
