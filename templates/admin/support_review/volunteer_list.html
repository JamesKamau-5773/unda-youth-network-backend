{% extends "base.html" %}

{% block title %}Volunteer Submissions - Admin{% endblock %}

{% block content %}
<div class="sr-list-page">
<div class="hero-card">
    <div class="hero-card__inner">
        <div>
            <h1 class="hero-card__title">Volunteer Submissions</h1>
            <p class="hero-card__subtitle">Review and manage volunteer support applications</p>
        </div>
        <div class="hero-card__actions">
            <a href="{{ url_for('admin.support_review') }}" class="btn btn--secondary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Support Review
            </a>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="grid grid--4-col" style="gap: 1rem; margin-bottom: 2rem;">
    <div class="stat-card" style="border-color:#D6EAFC;">
        <div class="stat-card__value">{{ stats.total }}</div>
        <div class="stat-card__label">Total Applications</div>
    </div>
    <div class="stat-card" style="border-color:#B2EBF2; background:#E0F7FA;">
        <div class="stat-card__value">{{ stats.pending }}</div>
        <div class="stat-card__label">Pending Review</div>
    </div>
    <div class="stat-card" style="border-color:#B2EBF2; background:#E0F7FA;">
        <div class="stat-card__value">{{ stats.approved }}</div>
        <div class="stat-card__label">Approved</div>
    </div>
    <div class="stat-card" style="border-color:#D6EAFC; background:#ECF5FF;">
        <div class="stat-card__value">{{ stats.rejected }}</div>
        <div class="stat-card__label">Rejected</div>
    </div>
</div>

<!-- Filter Tabs -->
<div class="filter-tabs">
    <a href="{{ url_for('admin.volunteer_submissions', status='all') }}" 
       class="filter-tab {% if status_filter == 'all' %}filter-tab--active{% endif %}">
        All ({{ stats.total }})
    </a>
    <a href="{{ url_for('admin.volunteer_submissions', status='Pending') }}" 
       class="filter-tab {% if status_filter == 'Pending' %}filter-tab--active{% endif %}">
        Pending ({{ stats.pending }})
    </a>
    <a href="{{ url_for('admin.volunteer_submissions', status='Under Review') }}" 
       class="filter-tab {% if status_filter == 'Under Review' %}filter-tab--active{% endif %}">
        Under Review ({{ stats.under_review }})
    </a>
    <a href="{{ url_for('admin.volunteer_submissions', status='Approved') }}" 
       class="filter-tab {% if status_filter == 'Approved' %}filter-tab--active{% endif %}">
        Approved ({{ stats.approved }})
    </a>
    <a href="{{ url_for('admin.volunteer_submissions', status='Rejected') }}" 
       class="filter-tab {% if status_filter == 'Rejected' %}filter-tab--active{% endif %}">
        Rejected ({{ stats.rejected }})
    </a>
</div>

<!-- Submissions List -->
<div style="margin-top: 1.5rem;">
    {% if submissions %}
        {% for sub in submissions %}
        <div class="data-card" style="margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                <div>
                    <h3 style="margin: 0 0 0.5rem 0; font-size: 1.25rem; font-weight: 600; color: #0B1E3B;">
                        {{ sub.full_name }}
                    </h3>
                    <p style="margin: 0 0 0.25rem 0; color: #627d98; font-size: 0.875rem;">
                        <strong>Email:</strong> {{ sub.email }}
                        {% if sub.phone %} &middot; <strong>Phone:</strong> {{ sub.phone }}{% endif %}
                    </p>
                    <p style="margin: 0; color: #627d98; font-size: 0.875rem;">
                        Submitted {{ sub.submitted_at.strftime('%B %d, %Y at %I:%M %p') }}
                    </p>
                </div>
                <div style="text-align: right;">
                    <div class="pill pill--{{ 
                        'unda-pending' if sub.status == 'Pending' else 
                        ('unda-review' if sub.status == 'Under Review' else 
                        ('unda-approved' if sub.status == 'Approved' else 'unda-rejected'))
                    }}">
                        {{ sub.status }}
                    </div>
                    <div style="margin-top: 0.5rem; font-size: 0.875rem; font-weight: 600; color: #00838F;">
                        {{ sub.interest }}
                    </div>
                </div>
            </div>

            {% if sub.motivation %}
            <p style="color: #334e68; font-size: 0.875rem; margin: 0 0 1rem 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                {{ sub.motivation }}
            </p>
            {% endif %}

            <div style="border-top: 1px solid #D6EAFC; padding-top: 1rem; display: flex; gap: 0.75rem;">
                <a href="{{ url_for('admin.volunteer_submission_detail', submission_id=sub.submission_id) }}" class="btn btn--primary btn--sm">
                    View Details
                </a>
                {% if sub.status == 'Pending' %}
                <form method="POST" action="{{ url_for('admin.mark_volunteer_under_review', submission_id=sub.submission_id) }}" style="margin: 0;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn--secondary btn--sm">Mark Under Review</button>
                </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#627d98" stroke-width="1.5" style="margin-bottom: 1rem;">
                <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
            </svg>
            <h3 style="margin: 0 0 0.5rem; font-size: 1.125rem; color: #334e68;">No volunteer submissions found</h3>
            <p style="margin: 0; color: #627d98; font-size: 0.875rem;">
                {% if status_filter != 'all' %}
                    No submissions with status "{{ status_filter }}". 
                    <a href="{{ url_for('admin.volunteer_submissions', status='all') }}">View all</a>
                {% else %}
                    Volunteer applications from the website will appear here.
                {% endif %}
            </p>
        </div>
    {% endif %}
</div>

</div>

<style>
.sr-list-page .hero-card { background:#ECF5FF; border:1px solid #D6EAFC; }
.sr-list-page .hero-card__title { color:#0B1E3B; }
.sr-list-page .hero-card__subtitle { color:#486581; }
.sr-list-page .btn--secondary { background:#00ACC1; border-color:#00ACC1; color:#ECF5FF; }
.sr-list-page .btn--secondary:hover { background:#00838F; border-color:#00838F; }
.sr-list-page .filter-tab { color:#486581; border-color:#D6EAFC; background:#ECF5FF; }
.sr-list-page .filter-tab--active { background:#00ACC1; color:#ECF5FF; border-color:#00ACC1; }
.sr-list-page .pill--unda-pending { background:#E0F7FA; color:#00838F; }
.sr-list-page .pill--unda-review { background:#D6EAFC; color:#486581; }
.sr-list-page .pill--unda-approved { background:#E0F7FA; color:#00838F; }
.sr-list-page .pill--unda-rejected { background:#ECF5FF; color:#486581; }
</style>
{% endblock %}
