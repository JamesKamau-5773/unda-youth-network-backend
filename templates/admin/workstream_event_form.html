{% extends "admin/base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto px-6 py-8">

  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
    <div>
      <h1 class="text-3xl font-black text-[#0B1E3B] tracking-tight">
        {{ action }} Workstream Event
      </h1>
      <p class="text-[#006064] font-bold text-sm mt-1">
        Create events for Annual Conference, UMV Global, and other programs.
      </p>
    </div>
    <div class="flex gap-3">
      <a href="{{ url_for('admin.workstream_events') }}"
         class="inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl text-sm font-bold text-[#00838F] bg-white border border-[#D6EAFC] hover:bg-[#ECF5FF] transition-colors">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        Back
      </a>
    </div>
  </div>

  <div class="bg-white rounded-[2rem] border border-[#D6EAFC] shadow-sm">
    <div class="p-8">
      <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

        <div class="mb-6">
          <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Program</label>
          <select name="event_type" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" required>
            {% set selected_type = normalized_type if normalized_type is defined else (event.event_type if event else '') %}
            <option value="">Select program</option>
            <option value="conference" {{ 'selected' if selected_type == 'conference' else '' }}>Annual Conference</option>
            <option value="international" {{ 'selected' if selected_type == 'international' else '' }}>UMV Global (International)</option>
            <option value="debate" {{ 'selected' if selected_type == 'debate' else '' }}>Debaters Circle</option>
            <option value="mtaani" {{ 'selected' if selected_type == 'mtaani' else '' }}>UMV Mtaani</option>
            <option value="campus" {{ 'selected' if selected_type == 'campus' else '' }}>Campus Edition</option>
          </select>
          <p class="text-xs text-[#00838F]/70 mt-2">Use "international" for UMV Global events.</p>
        </div>

        <div class="mb-6">
          <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Title</label>
          <input type="text" name="title" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" required value="{{ event.title if event else '' }}" placeholder="Event title" />
        </div>

        <div class="mb-6">
          <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Description</label>
          <textarea name="description" rows="4" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-medium outline-none resize-none" placeholder="Event details">{{ event.description if event else '' }}</textarea>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Event Date &amp; Time</label>
            <input type="datetime-local" name="event_date" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" required value="{{ event.event_date.strftime('%Y-%m-%dT%H:%M') if event and event.event_date else '' }}" />
          </div>
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Registration Deadline</label>
            <input type="datetime-local" name="registration_deadline" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" value="{{ event.registration_deadline.strftime('%Y-%m-%dT%H:%M') if event and event.registration_deadline else '' }}" />
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Location</label>
            <input type="text" name="location" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" value="{{ event.location if event else '' }}" placeholder="Venue or virtual link" />
          </div>
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Organizer</label>
            <input type="text" name="organizer" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" value="{{ event.organizer if event else '' }}" placeholder="Host name or team" />
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Max Participants</label>
            <input type="number" name="max_participants" min="1" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" value="{{ event.max_participants if event and event.max_participants else '' }}" placeholder="Optional cap" />
          </div>
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Status</label>
            {% set status_value = event.status if event else 'Upcoming' %}
            <select name="status" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none">
              <option value="Upcoming" {{ 'selected' if status_value == 'Upcoming' else '' }}>Upcoming</option>
              <option value="Ongoing" {{ 'selected' if status_value == 'Ongoing' else '' }}>Ongoing</option>
              <option value="Completed" {{ 'selected' if status_value == 'Completed' else '' }}>Completed</option>
              <option value="Cancelled" {{ 'selected' if status_value == 'Cancelled' else '' }}>Cancelled</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-bold text-[#006064] uppercase tracking-wider mb-2">Cover Image URL</label>
            <input type="url" name="image_url" class="w-full px-4 py-3 rounded-xl bg-[#ECF5FF] border border-transparent focus:bg-white focus:border-[#00ACC1] text-[#0B1E3B] font-bold outline-none" value="{{ event.image_url if event else '' }}" placeholder="Optional hero image" />
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-3">
          <button type="submit" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-sm font-bold text-white bg-[#00838F] hover:bg-[#006064] shadow-lg shadow-[#00838F]/20 transition-transform hover:-translate-y-0.5">
            {{ 'Update Event' if event else 'Create Event' }}
          </button>
          <a href="{{ url_for('admin.workstream_events') }}" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-sm font-bold text-[#00838F] bg-white border border-[#D6EAFC] hover:bg-[#ECF5FF] transition-colors">
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>

</div>
{% endblock %}
